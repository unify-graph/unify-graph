# Unify Graph - CUE Investigation Model

## Context Budget Warning

**DO NOT read these large generated JSON files** — they will blow up the context window:
- `discovery.json`, `discovery2.json` — raw discovery data (up to 1.1MB)
- `graph.json`, `report.json`, `insights.json`, `analysis_export.json` — build outputs
- `site/data/*.json` — deployed site data

These are all regenerated by `./build.sh` and gitignored. If you need to inspect their structure, use `head -c 500` via Bash instead of reading the full file.

## Project Structure

- **CUE source files** (`*.cue`) — the authoritative data model; edit these
- **`build.sh`** — exports CUE → JSON, copies to `site/data/`
- **`site/`** — static site with D3 visualization (deployed to GitHub Pages)
- **`scripts/`** — helper scripts
- **`.github/`** / `.gitlab-ci.yml` — CI pipelines
- **`.claude/commands/`** — custom slash commands (see below)
- **`.claude/agents/`** — agent prompt templates (reference docs, not auto-registered)

## Token-Cheap Research

Use `model: "haiku"` with the Task tool for cheap research (~20x cheaper than Opus). Preferred patterns:

| Task | Subagent Type | When to Use |
|------|---------------|-------------|
| CUE data queries | `Explore` + haiku | Entity lookups, schema questions, coverage stats |
| Viz code exploration | `Explore` + haiku | Finding D3 view code, debugging rendering |
| Build validation | `Bash` + haiku | Running build.sh, checking CUE validation |
| Broad codebase research | `general-purpose` + haiku | Multi-file exploration, architecture questions |

### Custom Slash Commands

| Command | Purpose |
|---------|---------|
| `/build` | Run build pipeline, report pass/fail |
| `/graph-stats` | Entity/connection/evidence counts from CUE source |
| `/push-both` | Push to both GitLab + GitHub remotes |
| `/cue-query` | Answer CUE data model questions via haiku agent |
| `/viz-query` | Answer D3 visualization questions via haiku agent |

### Delegation Rule of Thumb

- **Haiku** (delegate): Counting, grepping, file lookups, build runs, simple cross-references
- **Opus** (keep): Multi-file edits, architectural decisions, complex debugging, security-sensitive code
